# ðŸ•µï¸ ELITE DEEP TRACE: PHASE 3 - PULSAR ("The Translator")
**Role**: Prompt Engineer & Model Gateway.
**Protocol**: Level 5 (Maximum Oversight)
**Dashboard State**: ðŸŸ£ `PULSAR_TRANSMUTING` (Fast Flicker)

## 1. THE INPUT ARTIFACT (From Phase 2)
**Interface: Planner -> Pulsar**
Pulsar receives a specific node from the **Execution Blueprint**.
*   **Task**: "PROMPT_OPTIMIZE"
*   **Target**: "Refine 'AI Trends 2026' for Orion's Research Mode."

### 1.1 Structural Input Object
```json
{
  "blueprint_ref": "BP-2026-02-08-001",
  "step_id": 1,
  "target_agent": "ORION",
  "intent_context": {
    "raw": "temas sobre uso y aplicaciones de IA modernos 2026",
    "constraints": ["FOCUS_UTILITY", "FOCUS_PRACTICAL"]
  },
  "model_config": {
    "provider": "GEMINI_3_PRO",
    "temperature": 0.7
  }
}
```

## 2. THE PROCESS (Logic Kernel)

### 2.1 Micro-Step: High-Rigor Persona Injection
*   **Action**: Inject deep architectural protocols (not just "You are X").
*   **Protocol**: Load `STD_FORECASTER_V3` (Standard Directive).
*   **Directive**: "Execute under ISO-2026 Analysis Standards. No hallucinations. Citation required for every claim."

### 2.2 Micro-Step: Multi-Variant Engineering (The Transmutation)
*   **Action**: Generate **3 Distinct Prompt Variations**.
*   **Selection Logic**:
    *   *Var A (Analytical)*: High precision, dry.
    *   *Var B (Creative)*: High lateral thinking.
    *   *Var C (Contrarian)*: Devils Advocate.
*   **Decision**: Select **BEST MATCH** for current intent. Bank the other 2 as "Pending Analysis" (visible in Dash).

### 2.3 Micro-Step: Safety & Jailbreak Wrapping
*   **Action**: Wrap prompt in "Reverse Jailbreak" to prevent refusal while ensuring safety.
*   **Output**: 2 Options per prompt (Strict vsymetric).

## 3. THE OUTPUT INTERFACE (Pulsar -> Orion)

### 3.1 Prompt Matrix V2 (Dynamic)
```json
{
  "matrix_id": "PMX-2026-02-08-001",
  "selected_variant": "VAR_A",
  "banked_variants": ["VAR_B", "VAR_C"],
  "structure": {
    "system_header": "[DYNAMIC_PERSONA_BLOCK]",
    "context_injection": "[DYNAMIC_PLANNER_VARS]",
    "task_directive": "[OPTIMIZED_INTENT]"
  }
}
```

## 4. DASHBOARD SIGNALS & CONTROL

### 4.1 Status Indicators
*   **Led Color**: ðŸŸ£ **PURPLE (Flicker)** = `OPTIMIZING`.
*   **Message**: "Generating 3 Variants... Selecting Top Candidate."
*   **Visual**: Diff View (All Elements: Raw vs Optimized).
*   **Timer**: `15s` Count Down (Auto-Proceed).

### 4.2 User Intervention Controls ("The Prompt Review")
*   **Trigger**: Pulsar finishes Matrix. State -> ðŸŸ  `WAITING_APPROVAL`.
*   **Checkpoint Rule**: Auto-Pause if Confidence < 80%.
1.  **[APPROVE]** (Green): Lock Prompts. Send to Orion.
2.  **[MODIFY]** (Yellow): Edit specific variables.
3.  **[REGENERATE]**: Create new variations.
4.  **[PAUSE/STOP]**: Halt process.
5.  **[RESTART]**: Wipe State and retry Phase 3.

## 5. AUDIT LOG (The "Black Box" - 5 Levels)

| Level | Type | Message | Hash |
| :--- | :--- | :--- | :--- |
| **L1** | **IDENTITY** | `Pulsar activated by Planner Blueprint.` | `c4d5...` |
| **L2** | **RESOURCE** | `Notional Cost: $0.00 (Internal Logic).` | `e6f7...` |
| **L3** | **DECISION** | `Strategy: FORECASTER_PERSONA + COT_REASONING.` | `g8h9...` |
| **L4** | **DATA** | `Prompt expansion: 10 words -> 150 words.` | `i0j1...` |
| **L5** | **STATE** | `Transition: TRANSMUTING -> PROMPTS_READY.` | `k2l3...` |

---
**NEXT**: **PHASE 4: ORION (The Analyst)**
*Dependency*: User Approval of Prompt Matrix.
